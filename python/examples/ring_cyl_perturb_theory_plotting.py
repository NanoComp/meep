import matplotlib.pyplot as plt

drs=[0.001, 0.0016681, 0.00278256, 0.00464159, 0.00774264, 0.0129155, 0.02154435, 0.03593814, 0.05994843, 0.1]

Ez_perturb_theory_dw_dR=-0.03215640759553411
Ez_center_diff_dw_dR=[-0.07672983142606449, -0.07677194569192677, -0.07684200348304372, -0.07695823038558734, -0.07639356564465698, -0.07616503020203763, -0.07573087933051327, -0.07514883950275103, -0.07409900632240791, -0.07249598993775558]
Ez_Harminv_freqs_at_R_plus_dR=[0.14737568368907064, 0.1473243501966461, 0.14723859608122053, 0.14709520505768436, 0.14686092588580496, 0.1464687043280638, 0.14582084118513394, 0.14475170425825623, 0.14301029479504, 0.14020281452672115]
Ez_relative_errors_dw_dR=[0.5809138766775546, 0.5811437719115196, 0.5815256482396391, 0.5821576531266456, 0.5790691621188497, 0.577806146597263, 0.575385788732315, 0.5720970834904651, 0.5660345638695852, 0.5564388096066648]
Ez_relative_errors_freqs_at_R_plus_dR=[0.0003024476135734731, 0.0005051656631555832, 0.0008444818701709599, 0.001413721407888588, 0.002332221773481967, 0.003880646179397201, 0.006437924287274184, 0.010673918488219294, 0.017581900233297178, 0.028772305661904647]

Hz_perturb_theory_dw_dR=0.0006538749792265594
Hz_center_diff_dw_dR=[-0.12181206656644572, -0.12172879038656459, -0.12158990869173937, -0.12135768559031143, -0.12087126981812224, -0.12078482505458261, -0.11994719358648313, -0.1184257870989716, -0.11617926005362259, -0.1125145633936081]
Hz_Harminv_freqs_at_R_plus_dR=[0.183969830613279, 0.18388858681920892, 0.18375331153620175, 0.18352835020153638, 0.18315578033484822, 0.18253164667646418, 0.18150745873149857, 0.17983564056161444, 0.17712687901825994, 0.17284018634048465]
Hz_relative_errors_dw_dR=[1.0053678998941364, 1.0053715721412337, 1.005377707626085, 1.0053879980987275, 1.0054096807306687, 1.0054135523972574, 1.0054513570486758, 1.0055213901908044, 1.0056281558250997, 1.0058114697289373]
Hz_relative_errors_freqs_at_R_plus_dR=[0.0006656849176705357, 0.001110164547848598, 0.0018511263104392705, 0.003085776646983151, 0.005137293836816407, 0.00859270790596184, 0.014314955847475018, 0.023796735470310935, 0.039542064285092916, 0.06547576739468426]

#plt.figure(dpi=150)
#plt.loglog(drs, Ez_relative_errors_dw_dR, 'bo-', label='Parallel Fields')
#plt.loglog(drs, Hz_relative_errors_dw_dR, 'ro-', label='Perpendicular Fields')
#plt.grid(True, which='both', ls='-')
#plt.xlabel('perturbation amount $dR$')
#plt.ylabel('relative error between $dω/dR$')
#plt.legend(loc='upper right')
#plt.title('Comparison of Perturbation Theory and \nCenter-Difference Calculations in Finding $dω/dR$')
#plt.tight_layout()
#plt.show()
# plt.savefig('ring_Hz_perturbation_theory.dw_dR_error.png')
#plt.clf()

plt.figure(dpi=150)
plt.loglog(drs, Ez_relative_errors_freqs_at_R_plus_dR, 'bo-', label='Parallel Fields')
plt.loglog(drs, Hz_relative_errors_freqs_at_R_plus_dR, 'ro-', label='Perpendicular Fields')
plt.grid(True, which='both', ls='-')
plt.xlabel('perturbation amount $dR$')
plt.ylabel('relative error between $ω(R+dR)$')
plt.legend(loc='upper left')
plt.title('Comparison of resonance frequencies at $R+dR$ predicted by\nperturbation theory and found with Harminv')
plt.tight_layout()
#plt.show()
plt.savefig('ring_cyl_perturbation_theory.freqs_error.png')
# plt.clf()
